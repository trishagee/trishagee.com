{
 "disqus_url" : "http://trishagee.github.io/post/schemaless/",
 "disqus_title" : "Schema-less?",
 "Title": "Schema-less?",
 "Pubdate": "2012-10-22",
 "Slug": "schemaless",
 "Section": "post"
}
<br /><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><b>Document</b></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;">Now MongoDB falls into category four, the document database.&nbsp; And as a NoSQL&nbsp;<i>n00b</i>, this is now the product and area I know most about, and am clearly going to be more excited about since&nbsp;<a href="http://www.10gen.com/">10gen</a>&nbsp;are indoctrinating me in the Mongo way.</div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><br /></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Documents seem to me to be a familiar structure for developers, especially if they've been working with JSON.&nbsp;&nbsp;So, a document might be:</div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><br /></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">&lt;insert doc example here&gt;</div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><br /></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">To me, this looks like it maps closer to my domain-shaped Object Model than a relational database which always needs some sort of O-R mapping (whether you do this with hibernate or use Spring to do it yourself, you're still mapping tables into objects and vice versa).&nbsp;&nbsp;What I like about it is the nested sub-documents for data that belongs together.&nbsp;&nbsp;In relational databases you often end up denormalising for performance anyway, so why not just accept that up front and have it as part of the thing you're storing?</div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><br /></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">This does have a cost, of course - nothing is without trade-offs.&nbsp;&nbsp;Every time you request this document, you get the whole lot.&nbsp;&nbsp;You can't have the person without the address.&nbsp;&nbsp;So, you do need to understand the relationships (still) and whether you're usually going to want to get all that data at the same time or whether you might want to make two separate calls.</div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><br /></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Which brings me on to another thing which is familiar from relational days - foreign keys.&nbsp;&nbsp;A field in your document can be the ID of another document, so you can follow the links through and retrieve other documents associated with the starting one.&nbsp;&nbsp;Again, there are trade-offs here - each link you follow is a different request to the database.&nbsp;&nbsp;These database requests can be very quick, but if you wanted this data every time, you'd probably want it embeded in your first document to save the additional call.&nbsp;&nbsp;I guess it's a latency vs throughput question really - a single query which returns a chunky document, or multiple queries that return smaller ones.</div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><br /></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><br /></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">So schema design is still important in document databases even if you don't have a relational schema.&nbsp;&nbsp;No new technology is an excuse to stop thinking about the problem you're trying to solve and understanding the tradeoffs in design.</div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; min-height: 19px;"><br /></div><div style="font: normal normal normal 16px/normal Times; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">One of the advantages, it seems, of something like Mongo over some of the key/value databases is the ability to write ad-hoc queries, and to tune for those queries.&nbsp;&nbsp;The data is structured (it;s in a document) but it doesn't have to be in the same structure every time.&nbsp;&nbsp;But you can still query for people who have blue cars or people who live in London, or people who's surnames begin with G.&nbsp;&nbsp;If you find yourself doing the same query a number of times, you can add indexes to Mongo the same way you would a relational database.</div><div><br /></div>
